{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\AiPlanner\\\\frontend\\\\src\\\\pages\\\\RiwayatChat.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { getDatabase, ref, onValue, remove, update } from \"firebase/database\";\nimport \"../assets/Riwayat.css\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst RiwayatChat = () => {\n  _s();\n  const [chatList, setChatList] = useState([]);\n  const [selectedChat, setSelectedChat] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [filterDate, setFilterDate] = useState(\"all\");\n  const [editingChatId, setEditingChatId] = useState(null);\n  const [editTitle, setEditTitle] = useState(\"\");\n  const chatViewRef = useRef(null);\n  const db = getDatabase();\n\n  // Ambil username dari localStorage\n  useEffect(() => {\n    try {\n      const u = localStorage.getItem(\"username\");\n      if (u) {\n        setCurrentUser(u);\n      } else {\n        alert(\"Kamu belum login! Silakan masuk terlebih dahulu.\");\n        window.location.href = \"/login\";\n      }\n    } catch (e) {\n      console.warn(\"Gagal membaca localStorage:\", e);\n      window.location.href = \"/login\";\n    }\n  }, []);\n\n  // Ambil riwayat chat\n  useEffect(() => {\n    if (!currentUser) return;\n    const chatRef = ref(db, `chats/${currentUser}`);\n    const unsubscribe = onValue(chatRef, snapshot => {\n      const data = snapshot.val();\n      if (data) {\n        const chats = Object.entries(data).map(([id, value]) => ({\n          id,\n          ...value\n        }));\n\n        // Sort by date (newest first)\n        chats.sort((a, b) => new Date(b.date) - new Date(a.date));\n        setChatList(chats);\n      } else {\n        setChatList([]);\n      }\n      setLoading(false);\n    });\n    return () => unsubscribe();\n  }, [db, currentUser]);\n\n  // Auto scroll to bottom when chat selected\n  useEffect(() => {\n    if (chatViewRef.current) {\n      chatViewRef.current.scrollTop = chatViewRef.current.scrollHeight;\n    }\n  }, [selectedChat]);\n\n  // Handle select chat\n  const handleSelectChat = chat => {\n    setSelectedChat(chat);\n    setEditingChatId(null);\n  };\n\n  // Continue chat: dispatch event so Dashboard can switch to ChatAI with this chat\n  const handleContinueChat = (chat, e) => {\n    if (e) e.stopPropagation();\n    try {\n      // dispatch custom event\n      window.dispatchEvent(new CustomEvent('continueChat', {\n        detail: chat\n      }));\n      // also set a fallback in localStorage in case other tab needs it\n      localStorage.setItem('continueChat', JSON.stringify(chat));\n    } catch (err) {\n      console.warn('Unable to dispatch continueChat event, using localStorage fallback', err);\n      localStorage.setItem('continueChat', JSON.stringify(chat));\n    }\n  };\n\n  // Handle delete chat\n  const handleDeleteChat = (id, e) => {\n    if (e) e.stopPropagation();\n    if (window.confirm(\"Yakin ingin menghapus riwayat chat ini?\")) {\n      remove(ref(db, `chats/${currentUser}/${id}`));\n      if ((selectedChat === null || selectedChat === void 0 ? void 0 : selectedChat.id) === id) {\n        setSelectedChat(null);\n      }\n    }\n  };\n\n  // Handle delete all chats\n  const handleDeleteAll = () => {\n    if (chatList.length === 0) {\n      alert(\"Tidak ada chat untuk dihapus\");\n      return;\n    }\n    const confirmed = window.confirm(`⚠️ PERINGATAN!\\n\\nAnda akan menghapus SEMUA riwayat chat (${chatList.length} percakapan).\\n\\nTindakan ini TIDAK DAPAT dibatalkan!\\n\\nLanjutkan?`);\n    if (confirmed) {\n      chatList.forEach(chat => {\n        remove(ref(db, `chats/${currentUser}/${chat.id}`));\n      });\n      setSelectedChat(null);\n      alert(\"✅ Semua riwayat chat berhasil dihapus!\");\n    }\n  };\n\n  // Handle edit chat title\n  const handleEditTitle = chat => {\n    setEditingChatId(chat.id);\n    setEditTitle(chat.title || generateChatTitle(chat));\n  };\n\n  // Save edited title\n  const handleSaveTitle = async chatId => {\n    if (!editTitle.trim()) {\n      alert(\"Judul tidak boleh kosong!\");\n      return;\n    }\n    try {\n      await update(ref(db, `chats/${currentUser}/${chatId}`), {\n        title: editTitle.trim()\n      });\n      setEditingChatId(null);\n    } catch (error) {\n      console.error(\"Error updating title:\", error);\n      alert(\"Gagal mengubah judul!\");\n    }\n  };\n\n  // Generate title from first message\n  const generateChatTitle = chat => {\n    if (chat.messages && chat.messages.length > 0) {\n      const firstUserMessage = chat.messages.find(m => m.sender === \"user\");\n      if (firstUserMessage) {\n        return firstUserMessage.text.substring(0, 40) + \"...\";\n      }\n    }\n    return \"Percakapan tanpa judul\";\n  };\n\n  // Filter chats\n  const filteredChats = chatList.filter(chat => {\n    // Search filter\n    const title = chat.title || generateChatTitle(chat);\n    const matchSearch = title.toLowerCase().includes(searchTerm.toLowerCase());\n\n    // Date filter\n    let matchDate = true;\n    if (filterDate !== \"all\") {\n      const chatDate = new Date(chat.date);\n      const today = new Date();\n      const diffTime = today - chatDate;\n      const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n      if (filterDate === \"today\") {\n        matchDate = diffDays === 0;\n      } else if (filterDate === \"week\") {\n        matchDate = diffDays <= 7;\n      } else if (filterDate === \"month\") {\n        matchDate = diffDays <= 30;\n      }\n    }\n    return matchSearch && matchDate;\n  });\n\n  // Format timestamp\n  const formatTimestamp = timestamp => {\n    if (!timestamp) return \"\";\n    const date = new Date(timestamp);\n    return date.toLocaleString(\"id-ID\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    });\n  };\n\n  // Format relative time\n  const formatRelativeTime = timestamp => {\n    if (!timestamp) return \"\";\n    const date = new Date(timestamp);\n    const now = new Date();\n    const diffTime = now - date;\n    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n    const diffHours = Math.floor(diffTime / (1000 * 60 * 60));\n    const diffMinutes = Math.floor(diffTime / (1000 * 60));\n    if (diffMinutes < 1) return \"Baru saja\";\n    if (diffMinutes < 60) return `${diffMinutes} menit lalu`;\n    if (diffHours < 24) return `${diffHours} jam lalu`;\n    if (diffDays === 1) return \"Kemarin\";\n    if (diffDays < 7) return `${diffDays} hari lalu`;\n    return date.toLocaleDateString(\"id-ID\", {\n      day: \"numeric\",\n      month: \"short\"\n    });\n  };\n\n  // Export chat\n  const handleExportChat = () => {\n    if (!selectedChat) return;\n    const chatText = selectedChat.messages.map(msg => {\n      const sender = msg.sender === \"user\" ? \"Anda\" : \"AI Assistant\";\n      return `[${sender}]: ${msg.text}`;\n    }).join(\"\\n\\n\");\n    const blob = new Blob([chatText], {\n      type: \"text/plain\"\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `chat-${selectedChat.id}.txt`;\n    a.click();\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Memuat riwayat chat...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"riwayat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-sidebar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sidebar-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header-title\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\uD83D\\uDCAC Riwayat Chat\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"subtitle\",\n            children: [chatList.length, \" percakapan tersimpan\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 11\n        }, this), chatList.length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-delete-all\",\n          onClick: handleDeleteAll,\n          title: \"Hapus semua chat\",\n          children: \"\\uD83D\\uDDD1\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sidebar-controls\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"search-box\",\n          children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n            width: \"18\",\n            height: \"18\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            strokeWidth: \"2\",\n            children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n              cx: \"11\",\n              cy: \"11\",\n              r: \"8\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"m21 21-4.35-4.35\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Cari chat...\",\n            value: searchTerm,\n            onChange: e => setSearchTerm(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"filter-select\",\n          value: filterDate,\n          onChange: e => setFilterDate(e.target.value),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"all\",\n            children: \"Semua Waktu\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"today\",\n            children: \"Hari Ini\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"week\",\n            children: \"Minggu Ini\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"month\",\n            children: \"Bulan Ini\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-list\",\n        children: filteredChats.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"empty-state-sidebar\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"empty-icon\",\n            children: \"\\uD83D\\uDCED\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Tidak ada chat ditemukan\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 13\n        }, this) : filteredChats.map(chat => {\n          var _chat$lastMessage;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `chat-item ${(selectedChat === null || selectedChat === void 0 ? void 0 : selectedChat.id) === chat.id ? \"active\" : \"\"}`,\n            onClick: () => handleSelectChat(chat),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-icon-wrapper\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"chat-icon\",\n                children: \"\\uD83E\\uDD16\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-info\",\n              children: [editingChatId === chat.id ? /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                className: \"edit-title-input\",\n                value: editTitle,\n                onChange: e => setEditTitle(e.target.value),\n                onBlur: () => handleSaveTitle(chat.id),\n                onKeyDown: e => {\n                  if (e.key === \"Enter\") handleSaveTitle(chat.id);\n                  if (e.key === \"Escape\") setEditingChatId(null);\n                },\n                autoFocus: true,\n                onClick: e => e.stopPropagation()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"h4\", {\n                children: chat.title || generateChatTitle(chat)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 317,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"chat-date\",\n                children: formatRelativeTime(chat.date)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 319,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"chat-preview\",\n                children: [((_chat$lastMessage = chat.lastMessage) === null || _chat$lastMessage === void 0 ? void 0 : _chat$lastMessage.substring(0, 50)) || \"Tidak ada pesan\", \"...\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-actions\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"action-btn continue\",\n                onClick: e => {\n                  e.stopPropagation();\n                  handleContinueChat(chat);\n                },\n                title: \"Lanjutkan percakapan\",\n                children: \"\\u25B6\\uFE0F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 326,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"action-btn edit\",\n                onClick: e => {\n                  e.stopPropagation();\n                  handleEditTitle(chat);\n                },\n                title: \"Edit judul\",\n                children: \"\\u270F\\uFE0F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 336,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"action-btn delete\",\n                onClick: e => handleDeleteChat(chat.id, e),\n                title: \"Hapus chat\",\n                children: \"\\uD83D\\uDDD1\\uFE0F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 346,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 17\n            }, this)]\n          }, chat.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-view\",\n      children: selectedChat ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-view-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: selectedChat.title || generateChatTitle(selectedChat)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: formatTimestamp(selectedChat.date)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-export\",\n              onClick: handleExportChat,\n              title: \"Export chat\",\n              children: \"\\uD83D\\uDCE5 Export\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 370,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-delete\",\n              onClick: e => handleDeleteChat(selectedChat.id, e),\n              title: \"Hapus chat\",\n              children: \"\\uD83D\\uDDD1\\uFE0F Hapus\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-messages\",\n          ref: chatViewRef,\n          children: selectedChat.messages && selectedChat.messages.length > 0 ? selectedChat.messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `message-wrapper ${msg.sender === \"user\" ? \"user\" : \"ai\"}`,\n            children: [msg.sender === \"ai\" && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-avatar\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bot-icon\",\n                children: \"\\uD83E\\uDD16\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 392,\n                columnNumber: 25\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 23\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-bubble\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"message-text\",\n                children: msg.text.split(\"\\n\").map((line, i) => /*#__PURE__*/_jsxDEV(React.Fragment, {\n                  children: [line, i < msg.text.split(\"\\n\").length - 1 && /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 401,\n                    columnNumber: 69\n                  }, this)]\n                }, i, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 399,\n                  columnNumber: 27\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 397,\n                columnNumber: 23\n              }, this), msg.timestamp && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"message-time\",\n                children: new Date(msg.timestamp).toLocaleTimeString(\"id-ID\", {\n                  hour: \"2-digit\",\n                  minute: \"2-digit\"\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 406,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 396,\n              columnNumber: 21\n            }, this), msg.sender === \"user\" && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-avatar user-avatar\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"user-icon\",\n                children: currentUser.charAt(0).toUpperCase()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 417,\n                columnNumber: 25\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 416,\n              columnNumber: 23\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 19\n          }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"empty-messages\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Tidak ada pesan dalam percakapan ini\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 426,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-empty\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"empty-icon-large\",\n          children: \"\\uD83D\\uDCAC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Belum ada chat yang dipilih\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Pilih salah satu percakapan di sebelah kiri untuk melihat isinya\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 239,\n    columnNumber: 5\n  }, this);\n};\n_s(RiwayatChat, \"dvPmhFOcF3nnKu+yMDyWWVfXOpM=\");\n_c = RiwayatChat;\nexport default RiwayatChat;\nvar _c;\n$RefreshReg$(_c, \"RiwayatChat\");","map":{"version":3,"names":["React","useEffect","useState","useRef","getDatabase","ref","onValue","remove","update","jsxDEV","_jsxDEV","Fragment","_Fragment","RiwayatChat","_s","chatList","setChatList","selectedChat","setSelectedChat","loading","setLoading","currentUser","setCurrentUser","searchTerm","setSearchTerm","filterDate","setFilterDate","editingChatId","setEditingChatId","editTitle","setEditTitle","chatViewRef","db","u","localStorage","getItem","alert","window","location","href","e","console","warn","chatRef","unsubscribe","snapshot","data","val","chats","Object","entries","map","id","value","sort","a","b","Date","date","current","scrollTop","scrollHeight","handleSelectChat","chat","handleContinueChat","stopPropagation","dispatchEvent","CustomEvent","detail","setItem","JSON","stringify","err","handleDeleteChat","confirm","handleDeleteAll","length","confirmed","forEach","handleEditTitle","title","generateChatTitle","handleSaveTitle","chatId","trim","error","messages","firstUserMessage","find","m","sender","text","substring","filteredChats","filter","matchSearch","toLowerCase","includes","matchDate","chatDate","today","diffTime","diffDays","Math","floor","formatTimestamp","timestamp","toLocaleString","year","month","day","hour","minute","formatRelativeTime","now","diffHours","diffMinutes","toLocaleDateString","handleExportChat","chatText","msg","join","blob","Blob","type","url","URL","createObjectURL","document","createElement","download","click","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","width","height","viewBox","fill","stroke","strokeWidth","cx","cy","r","d","placeholder","onChange","target","_chat$lastMessage","onBlur","onKeyDown","key","autoFocus","lastMessage","index","split","line","i","toLocaleTimeString","charAt","toUpperCase","_c","$RefreshReg$"],"sources":["C:/Users/User/AiPlanner/frontend/src/pages/RiwayatChat.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { getDatabase, ref, onValue, remove, update } from \"firebase/database\";\r\nimport \"../assets/Riwayat.css\";\r\n\r\nconst RiwayatChat = () => {\r\n  const [chatList, setChatList] = useState([]);\r\n  const [selectedChat, setSelectedChat] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [currentUser, setCurrentUser] = useState(null);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [filterDate, setFilterDate] = useState(\"all\");\r\n  const [editingChatId, setEditingChatId] = useState(null);\r\n  const [editTitle, setEditTitle] = useState(\"\");\r\n  const chatViewRef = useRef(null);\r\n\r\n  const db = getDatabase();\r\n\r\n  // Ambil username dari localStorage\r\n  useEffect(() => {\r\n    try {\r\n      const u = localStorage.getItem(\"username\");\r\n      if (u) {\r\n        setCurrentUser(u);\r\n      } else {\r\n        alert(\"Kamu belum login! Silakan masuk terlebih dahulu.\");\r\n        window.location.href = \"/login\";\r\n      }\r\n    } catch (e) {\r\n      console.warn(\"Gagal membaca localStorage:\", e);\r\n      window.location.href = \"/login\";\r\n    }\r\n  }, []);\r\n\r\n  // Ambil riwayat chat\r\n  useEffect(() => {\r\n    if (!currentUser) return;\r\n\r\n    const chatRef = ref(db, `chats/${currentUser}`);\r\n    const unsubscribe = onValue(chatRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      if (data) {\r\n        const chats = Object.entries(data).map(([id, value]) => ({\r\n          id,\r\n          ...value,\r\n        }));\r\n\r\n        // Sort by date (newest first)\r\n        chats.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n        setChatList(chats);\r\n      } else {\r\n        setChatList([]);\r\n      }\r\n      setLoading(false);\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, [db, currentUser]);\r\n\r\n  // Auto scroll to bottom when chat selected\r\n  useEffect(() => {\r\n    if (chatViewRef.current) {\r\n      chatViewRef.current.scrollTop = chatViewRef.current.scrollHeight;\r\n    }\r\n  }, [selectedChat]);\r\n\r\n  // Handle select chat\r\n  const handleSelectChat = (chat) => {\r\n    setSelectedChat(chat);\r\n    setEditingChatId(null);\r\n  };\r\n\r\n  // Continue chat: dispatch event so Dashboard can switch to ChatAI with this chat\r\n  const handleContinueChat = (chat, e) => {\r\n    if (e) e.stopPropagation();\r\n    try {\r\n      // dispatch custom event\r\n      window.dispatchEvent(new CustomEvent('continueChat', { detail: chat }));\r\n      // also set a fallback in localStorage in case other tab needs it\r\n      localStorage.setItem('continueChat', JSON.stringify(chat));\r\n    } catch (err) {\r\n      console.warn('Unable to dispatch continueChat event, using localStorage fallback', err);\r\n      localStorage.setItem('continueChat', JSON.stringify(chat));\r\n    }\r\n  };\r\n\r\n  // Handle delete chat\r\n  const handleDeleteChat = (id, e) => {\r\n    if (e) e.stopPropagation();\r\n\r\n    if (window.confirm(\"Yakin ingin menghapus riwayat chat ini?\")) {\r\n      remove(ref(db, `chats/${currentUser}/${id}`));\r\n      if (selectedChat?.id === id) {\r\n        setSelectedChat(null);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Handle delete all chats\r\n  const handleDeleteAll = () => {\r\n    if (chatList.length === 0) {\r\n      alert(\"Tidak ada chat untuk dihapus\");\r\n      return;\r\n    }\r\n\r\n    const confirmed = window.confirm(\r\n      `⚠️ PERINGATAN!\\n\\nAnda akan menghapus SEMUA riwayat chat (${chatList.length} percakapan).\\n\\nTindakan ini TIDAK DAPAT dibatalkan!\\n\\nLanjutkan?`\r\n    );\r\n\r\n    if (confirmed) {\r\n      chatList.forEach((chat) => {\r\n        remove(ref(db, `chats/${currentUser}/${chat.id}`));\r\n      });\r\n      setSelectedChat(null);\r\n      alert(\"✅ Semua riwayat chat berhasil dihapus!\");\r\n    }\r\n  };\r\n\r\n  // Handle edit chat title\r\n  const handleEditTitle = (chat) => {\r\n    setEditingChatId(chat.id);\r\n    setEditTitle(chat.title || generateChatTitle(chat));\r\n  };\r\n\r\n  // Save edited title\r\n  const handleSaveTitle = async (chatId) => {\r\n    if (!editTitle.trim()) {\r\n      alert(\"Judul tidak boleh kosong!\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await update(ref(db, `chats/${currentUser}/${chatId}`), {\r\n        title: editTitle.trim(),\r\n      });\r\n      setEditingChatId(null);\r\n    } catch (error) {\r\n      console.error(\"Error updating title:\", error);\r\n      alert(\"Gagal mengubah judul!\");\r\n    }\r\n  };\r\n\r\n  // Generate title from first message\r\n  const generateChatTitle = (chat) => {\r\n    if (chat.messages && chat.messages.length > 0) {\r\n      const firstUserMessage = chat.messages.find((m) => m.sender === \"user\");\r\n      if (firstUserMessage) {\r\n        return firstUserMessage.text.substring(0, 40) + \"...\";\r\n      }\r\n    }\r\n    return \"Percakapan tanpa judul\";\r\n  };\r\n\r\n  // Filter chats\r\n  const filteredChats = chatList.filter((chat) => {\r\n    // Search filter\r\n    const title = chat.title || generateChatTitle(chat);\r\n    const matchSearch = title.toLowerCase().includes(searchTerm.toLowerCase());\r\n\r\n    // Date filter\r\n    let matchDate = true;\r\n    if (filterDate !== \"all\") {\r\n      const chatDate = new Date(chat.date);\r\n      const today = new Date();\r\n      const diffTime = today - chatDate;\r\n      const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\r\n\r\n      if (filterDate === \"today\") {\r\n        matchDate = diffDays === 0;\r\n      } else if (filterDate === \"week\") {\r\n        matchDate = diffDays <= 7;\r\n      } else if (filterDate === \"month\") {\r\n        matchDate = diffDays <= 30;\r\n      }\r\n    }\r\n\r\n    return matchSearch && matchDate;\r\n  });\r\n\r\n  // Format timestamp\r\n  const formatTimestamp = (timestamp) => {\r\n    if (!timestamp) return \"\";\r\n    const date = new Date(timestamp);\r\n    return date.toLocaleString(\"id-ID\", {\r\n      year: \"numeric\",\r\n      month: \"long\",\r\n      day: \"numeric\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n  };\r\n\r\n  // Format relative time\r\n  const formatRelativeTime = (timestamp) => {\r\n    if (!timestamp) return \"\";\r\n    const date = new Date(timestamp);\r\n    const now = new Date();\r\n    const diffTime = now - date;\r\n    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\r\n    const diffHours = Math.floor(diffTime / (1000 * 60 * 60));\r\n    const diffMinutes = Math.floor(diffTime / (1000 * 60));\r\n\r\n    if (diffMinutes < 1) return \"Baru saja\";\r\n    if (diffMinutes < 60) return `${diffMinutes} menit lalu`;\r\n    if (diffHours < 24) return `${diffHours} jam lalu`;\r\n    if (diffDays === 1) return \"Kemarin\";\r\n    if (diffDays < 7) return `${diffDays} hari lalu`;\r\n    return date.toLocaleDateString(\"id-ID\", { day: \"numeric\", month: \"short\" });\r\n  };\r\n\r\n  // Export chat\r\n  const handleExportChat = () => {\r\n    if (!selectedChat) return;\r\n\r\n    const chatText = selectedChat.messages\r\n      .map((msg) => {\r\n        const sender = msg.sender === \"user\" ? \"Anda\" : \"AI Assistant\";\r\n        return `[${sender}]: ${msg.text}`;\r\n      })\r\n      .join(\"\\n\\n\");\r\n\r\n    const blob = new Blob([chatText], { type: \"text/plain\" });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement(\"a\");\r\n    a.href = url;\r\n    a.download = `chat-${selectedChat.id}.txt`;\r\n    a.click();\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"loading-container\">\r\n        <div className=\"loading-spinner\"></div>\r\n        <p>Memuat riwayat chat...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"riwayat-container\">\r\n      {/* Sidebar - Chat List */}\r\n      <div className=\"chat-sidebar\">\r\n        <div className=\"sidebar-header\">\r\n          <div className=\"header-title\">\r\n            <h2>💬 Riwayat Chat</h2>\r\n            <p className=\"subtitle\">\r\n              {chatList.length} percakapan tersimpan\r\n            </p>\r\n          </div>\r\n          {chatList.length > 0 && (\r\n            <button className=\"btn-delete-all\" onClick={handleDeleteAll} title=\"Hapus semua chat\">\r\n              🗑️\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Search & Filter */}\r\n        <div className=\"sidebar-controls\">\r\n          <div className=\"search-box\">\r\n            <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n              <circle cx=\"11\" cy=\"11\" r=\"8\" />\r\n              <path d=\"m21 21-4.35-4.35\" />\r\n            </svg>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Cari chat...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n            />\r\n          </div>\r\n\r\n          <select\r\n            className=\"filter-select\"\r\n            value={filterDate}\r\n            onChange={(e) => setFilterDate(e.target.value)}\r\n          >\r\n            <option value=\"all\">Semua Waktu</option>\r\n            <option value=\"today\">Hari Ini</option>\r\n            <option value=\"week\">Minggu Ini</option>\r\n            <option value=\"month\">Bulan Ini</option>\r\n          </select>\r\n        </div>\r\n\r\n        {/* Chat List */}\r\n        <div className=\"chat-list\">\r\n          {filteredChats.length === 0 ? (\r\n            <div className=\"empty-state-sidebar\">\r\n              <div className=\"empty-icon\">📭</div>\r\n              <p>Tidak ada chat ditemukan</p>\r\n            </div>\r\n          ) : (\r\n            filteredChats.map((chat) => (\r\n              <div\r\n                key={chat.id}\r\n                className={`chat-item ${selectedChat?.id === chat.id ? \"active\" : \"\"}`}\r\n                onClick={() => handleSelectChat(chat)}\r\n              >\r\n                <div className=\"chat-icon-wrapper\">\r\n                  <span className=\"chat-icon\">🤖</span>\r\n                </div>\r\n\r\n                <div className=\"chat-info\">\r\n                  {editingChatId === chat.id ? (\r\n                    <input\r\n                      type=\"text\"\r\n                      className=\"edit-title-input\"\r\n                      value={editTitle}\r\n                      onChange={(e) => setEditTitle(e.target.value)}\r\n                      onBlur={() => handleSaveTitle(chat.id)}\r\n                      onKeyDown={(e) => {\r\n                        if (e.key === \"Enter\") handleSaveTitle(chat.id);\r\n                        if (e.key === \"Escape\") setEditingChatId(null);\r\n                      }}\r\n                      autoFocus\r\n                      onClick={(e) => e.stopPropagation()}\r\n                    />\r\n                  ) : (\r\n                    <h4>{chat.title || generateChatTitle(chat)}</h4>\r\n                  )}\r\n                  <p className=\"chat-date\">{formatRelativeTime(chat.date)}</p>\r\n                  <p className=\"chat-preview\">\r\n                    {chat.lastMessage?.substring(0, 50) || \"Tidak ada pesan\"}...\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"chat-actions\">\r\n                  <button\r\n                    className=\"action-btn continue\"\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleContinueChat(chat);\r\n                    }}\r\n                    title=\"Lanjutkan percakapan\"\r\n                  >\r\n                    ▶️\r\n                  </button>\r\n                  <button\r\n                    className=\"action-btn edit\"\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleEditTitle(chat);\r\n                    }}\r\n                    title=\"Edit judul\"\r\n                  >\r\n                    ✏️\r\n                  </button>\r\n                  <button\r\n                    className=\"action-btn delete\"\r\n                    onClick={(e) => handleDeleteChat(chat.id, e)}\r\n                    title=\"Hapus chat\"\r\n                  >\r\n                    🗑️\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main View - Chat Messages */}\r\n      <div className=\"chat-view\">\r\n        {selectedChat ? (\r\n          <>\r\n            <div className=\"chat-view-header\">\r\n              <div className=\"header-info\">\r\n                <h3>{selectedChat.title || generateChatTitle(selectedChat)}</h3>\r\n                <p>{formatTimestamp(selectedChat.date)}</p>\r\n              </div>\r\n              <div className=\"header-actions\">\r\n                <button className=\"btn-export\" onClick={handleExportChat} title=\"Export chat\">\r\n                  📥 Export\r\n                </button>\r\n                <button\r\n                  className=\"btn-delete\"\r\n                  onClick={(e) => handleDeleteChat(selectedChat.id, e)}\r\n                  title=\"Hapus chat\"\r\n                >\r\n                  🗑️ Hapus\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"chat-messages\" ref={chatViewRef}>\r\n              {selectedChat.messages && selectedChat.messages.length > 0 ? (\r\n                selectedChat.messages.map((msg, index) => (\r\n                  <div\r\n                    key={index}\r\n                    className={`message-wrapper ${msg.sender === \"user\" ? \"user\" : \"ai\"}`}\r\n                  >\r\n                    {msg.sender === \"ai\" && (\r\n                      <div className=\"message-avatar\">\r\n                        <div className=\"bot-icon\">🤖</div>\r\n                      </div>\r\n                    )}\r\n\r\n                    <div className=\"message-bubble\">\r\n                      <p className=\"message-text\">\r\n                        {msg.text.split(\"\\n\").map((line, i) => (\r\n                          <React.Fragment key={i}>\r\n                            {line}\r\n                            {i < msg.text.split(\"\\n\").length - 1 && <br />}\r\n                          </React.Fragment>\r\n                        ))}\r\n                      </p>\r\n                      {msg.timestamp && (\r\n                        <span className=\"message-time\">\r\n                          {new Date(msg.timestamp).toLocaleTimeString(\"id-ID\", {\r\n                            hour: \"2-digit\",\r\n                            minute: \"2-digit\",\r\n                          })}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n\r\n                    {msg.sender === \"user\" && (\r\n                      <div className=\"message-avatar user-avatar\">\r\n                        <div className=\"user-icon\">\r\n                          {currentUser.charAt(0).toUpperCase()}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <div className=\"empty-messages\">\r\n                  <p>Tidak ada pesan dalam percakapan ini</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </>\r\n        ) : (\r\n          <div className=\"chat-empty\">\r\n            <div className=\"empty-icon-large\">💬</div>\r\n            <h3>Belum ada chat yang dipilih</h3>\r\n            <p>Pilih salah satu percakapan di sebelah kiri untuk melihat isinya</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RiwayatChat;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}